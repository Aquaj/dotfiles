# Get External IP / local IPs
alias ip="curl ipinfo.io/ip"
alias ips="ifconfig -a | perl -nle'/(\d+\.\d+\.\d+\.\d+)/ && print $1'"
alias speedtest="wget -O /dev/null http://speedtest.wdc01.softlayer.com/downloads/test10.zip"

# Quickly serve the current directory as HTTP
alias serve='ruby -run -e httpd . -p 8000'  # Or python -m SimpleHTTPServer :)

# Replacing cat with bat, without losing cat
alias ccat=$(which cat)
alias cat=bat

# I want color on this !
alias ls='ls --color=auto'

# Easy local SSL setup
function easy_ssl() {
  name = $1.lan
  openssl req \
    -new \
    -newkey rsa:2048 \
    -sha256 \
    -days 3650 \
    -nodes \
    -x509 \
    -keyout $name.key \
    -out $name.crt \
    -config <(cat <<-EOF
    [req]
    distinguished_name = req_distinguished_name
    x509_extensions = v3_req
    prompt = no
    [req_distinguished_name]
    CN = $name
    [v3_req]
    keyUsage = keyEncipherment, dataEncipherment
    extendedKeyUsage = serverAuth
    subjectAltName = @alt_names
    [alt_names]
    DNS.1 = $name
    DNS.2 = *.$name
  EOF
  )
  sudo security add-trusted-cert -d -r trustRoot -k /Library/Keychains/System.keychain $name.crt
}

function rails_ssl() {
  easy_ssl $1
  mkdir -p $(git rev-parse --show-toplevel)/config/ssl
  mv $1.lan.key $1.lan.crt $(git rev-parse --show-toplevel)/config/ssl
  # Adjust Puma config with sed
  # Adjust webpacker config with sed
}
